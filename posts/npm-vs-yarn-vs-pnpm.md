---
title: "npm vs yarn vs pnpm vs yarn2"
subtitle: "pnpmì€ ì •ë§ë¡œ íƒ„ì†Œì ˆê°ê³¼ ssdìˆ˜ëª…ì— ë„ì›€ì„ ì¤„ê¹Œ?"
tags:
    - typescript,javascript
date: 2020-12-19
image: https://user-images.githubusercontent.com/34048253/155849011-f99a1dd2-7169-4f83-9ed4-a82390777d58.png
---

# ì„œë¡ 

íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ë°±ì—”ë“œë¥¼ ê°œë°œí•˜ë©´ì„œ `googleapis@39.2`ë¥¼ ì‚¬ìš©í•˜ë˜ ë„ì¤‘, ì˜ì¡´ì„±ìœ¼ë¡œ í•¨ê»˜ ì„¤ì¹˜ë˜ëŠ” `google-auth-library@3.0.0`ì˜ íƒ€ì…ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì˜ë¬¸ì„ ê°€ì§€ê²Œ ë˜ì—ˆë‹¤.

```typescript
// npm ìœ¼ë¡œ ì„¤ì¹˜í•´ì„œ ì‚¬ìš©í•˜ëŠ” ìƒí™©
import { google } from 'googleapis';
import { OAuth2Client } from 'google-auth-library';

const auth: OAuth2Client = new google.auth.OAuth2();
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-12-19 á„‹á…©á„’á…® 6 34 21](https://user-images.githubusercontent.com/34048253/102686125-e1d6ae00-4228-11eb-8f1d-a29ebcae10d9.png)

ì˜ì¡´ì„±ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë²„ì „ ë§ê³  ë‹¤ë¥¸ ë²„ì „ì„ ë³„ë„ë¡œ ì„¤ì¹˜í•˜ê³  ìˆì—ˆë‹¤ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ê±°ì§€? ì‹¶ì–´ì„œ `google-auth-library`ì˜ ìµœì‹ ë²„ì „ì„(6.1.3) ì¶”ê°€ë¡œ ì„¤ì¹˜í•´ë³´ì•˜ê³ , ì—­ì‹œë‚˜ ì•„ë˜ì™€ ê°™ì´ ì˜ëª»ëœ ë²„ì „ì˜ íƒ€ì…ì„ ê°€ì ¸ì˜¤ë©´ì„œ **TS2739** ì—ëŸ¬ê°€ ë‚¬ë‹¤.

![node_modules](https://user-images.githubusercontent.com/34048253/102686319-39c1e480-422a-11eb-8b88-f30f2228fe0e.gif)

ìœ„ì˜ ì—ëŸ¬ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ì–´ì©” ìˆ˜ ì—†ì´ `googleapis/node_modules/google-auth-library` ë¥¼ í†µí•´ ì ‘ê·¼í•´ì•¼ í–ˆë‹¤. (ì´ê²Œ ë§ëŠ”ê±´ê°€? ì‹¶ì—ˆë‹¤)

ê·¸ëŸ¬ë˜ ì–´ëŠë‚  [reason-seoul](https://github.com/reason-seoul/reason-todomvc) ë ˆí¬ì— ë‹¤ìŒê³¼ ê°™ì€ í¥ë¯¸ë¡œìš´ ë¬¸êµ¬ê°€ ìˆì–´ì„œ javascriptì˜ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì§• ë„êµ¬ë“¤ì— ëŒ€í•´ ì•Œì•„ë³´ëŠ” ì‹œê°„ì„ ê°€ì§€ê¸°ë¡œ í–ˆë‹¤.

```
ì €ì¥ì†ŒëŠ” íƒ„ì†Œë¥¼ ì ˆê°í•˜ê³  ìš°ë¦¬ë“¤ì˜ SSD ìˆ˜ëª…ì„ ì¡°ê¸ˆ ë” ë³´ì¡´í•˜ê¸° ìœ„í•´ pnpm íŒ¨í‚¤ì§€ ë§¤ë‹ˆì ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤ ğŸ˜‰
```

# ë¹„êµ

ì‰¬ìš´ ë¹„êµë¥¼ ìœ„í•´ ìœ„ì—ì„œ ì„¤ëª…í•œ íŒ¨í‚¤ì§€ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì´ë¦„ ì§€ì–´ì„œ ì„¤ëª…í•˜ê² ë‹¤.

- `foo@39`: `googleapis@39`
- `bar@3.0.0`: `google-auth-library@3.0.0` (googleapisì˜ ì˜ì¡´ì„±)
- `bar@6.1.3`: `google-auth-library@6.1.3`

## npm

#### 1. foo@39 ì„¤ì¹˜
- node_modules í•˜ìœ„ì— `foo`, `bar`ê°€ flatí•˜ê²Œ ì„¤ì¹˜ë˜ì—ˆë‹¤.

#### 2. bar@6.1.3 ì„¤ì¹˜
- ê¸°ì¡´ `node_modules`/`bar` í´ë”ì˜ ë‚´ìš©ì´ `foo`/`node_modules`/`bar`ë¡œ ì¦‰ì‹œ ì´ë™(mv)í•˜ëŠ”ê²ƒì´ ì•„ë‹Œ, `bar@3.0.0` ì‚­ì œ í›„ ê·¸ ìœ„ì¹˜ì— ìƒˆë¡œ `bar@6.1.3`ì„ ì„¤ì¹˜í•˜ê³ , `foo`/`node_modules`/`bar` ê²½ë¡œì— `bar`ê°€ ìƒˆë¡œ ì„¤ì¹˜ë˜ì—ˆë‹¤. ë‹¨ìˆœíˆ mvê°€ ì•„ë‹Œ ì‚­ì œë¼ê³  ê²°ë¡ ë‚´ë¦° ì´ìœ ëŠ”, `bar@6.1.3` ì„¤ì¹˜ ì „ì— `bar@3.0.0` í•˜ìœ„ì— ìƒˆë¡œìš´ íŒŒì¼ì„ ìƒì„±í•´ë³´ê³ , `bar@3.0.0`ì´ ê°€ì§€ê³ ìˆëŠ” README.md íŒŒì¼ì— ìˆ˜ì •ì„ ê°€í•œ ë’¤ì— `bar@6.1.3`ì„ ì„¤ì¹˜í–ˆê¸° ë•Œë¬¸ì´ë‹¤. ~ë¬¼ë¡  git reset --hard í›„ì— ì´ë™ì‹œì¼°ì„ ê°€ëŠ¥ì„±ë„ ì—†ì§€ëŠ” ì•Šë‹¤.~

#### 3. bar@6.1.3 ì‚­ì œ
- `node_modules`/`bar` í´ë”ê°€ ì œê±°ë˜ì—ˆê³ , `node_modules`/`foo`/`node_modules`/`bar`ê°€ `node_modules`/`bar`ë¡œ ëŒì•„ì˜¤ì§€ëŠ” ì•Šì•˜ë‹¤.

#### 4. bar@3.0.0ì„ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì¹˜
- `node_modules`/`bar` ê²½ë¡œì— `bar@3.0.0` ì´ ì„¤ì¹˜ë˜ì—ˆë‹¤.
- `node_modules`/`foo`/`node_modules`/`bar`ì—ëŠ” ë˜‘ê°™ì€ ë²„ì „ì˜ `bar@3.0.0`ì´ ë‚¨ì•„ìˆì–´ì„œ ê°™ì€ ë²„ì „ì˜ íŒ¨í‚¤ì§€ê°€ ì¤‘ë³µìœ¼ë¡œ ì¡´ì¬í•˜ê²Œ ëœë‹¤.

ë­”ê°€ ì•„ë˜ì˜ ì§¤ì´ ìƒê°ë‚œë‹¤...

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-27 á„‹á…©á„Œá…¥á†« 12 34 28](https://user-images.githubusercontent.com/34048253/155849011-f99a1dd2-7169-4f83-9ed4-a82390777d58.png)

## yarn (version 1ì„ ë‹¤ë£¹ë‹ˆë‹¤)

#### 1. foo@39 ì„¤ì¹˜
- npmê³¼ ë§ˆì°¬ê°€ì§€ë¡œ node_modules í•˜ìœ„ì— `foo`, `bar`ê°€ flatí•˜ê²Œ ì„¤ì¹˜ë˜ì—ˆë‹¤.

#### 2. bar@6.1.3 ì„¤ì¹˜
- npmìœ¼ë¡œ ì„¤ì¹˜í–ˆì„ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë™ì‘í•˜ì˜€ë‹¤.

#### 3. bar@6.1.3 ì‚­ì œ
- `node_modules`/`bar`ì— ì„¤ì¹˜ë˜ì–´ìˆë˜ `bar@6.1.3`ì´ ì‚­ì œë˜ê³ , `node_modules`/`foo`/`node_modules`/`bar` í•˜ìœ„í´ë”ì— ìˆë˜ `bar@3.0.0`ì´ ì‚­ì œë˜ê³ , ì²˜ìŒ ì„¤ì¹˜ ìœ„ì¹˜ì¸ `node_modules`/`bar`ì— ë‹¤ì‹œ ì„¤ì¹˜ë˜ì–´ `foo`ì™€ flatí•œ ìœ„ì¹˜ì— ì¡´ì¬í•˜ê²Œ ë˜ì—ˆë‹¤.

#### 4. foo@39ê°€ ì˜ì¡´ì„±ì„ ê°€ì§€ëŠ” bar@3.0.0 ìˆ˜ë™ìœ¼ë¡œ ì„¤ì¹˜
- `node_modules`/`bar`ì— ê°™ì€ ë²„ì „ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì•„ë¬´ ì¼ë„ ì¼ì–´ë‚˜ì§€ ì•Šì•˜ë‹¤.

## pnpm

#### 1. foo@39 ì„¤ì¹˜
- `foo@39` (ì •í™•íˆëŠ” `googleapis@39.2.0`) ì˜ [package.json](https://github.com/googleapis/google-api-nodejs-client/blob/v39.2.0/package.json)ì—ëŠ” `bar@3.0.0`ì´ ì˜ì¡´ì„±ìœ¼ë¡œ ëª…ì‹œë˜ì—ˆì§€ë§Œ, `^3.0.0`ìœ¼ë¡œ ëª…ì‹œë˜ì–´ìˆê¸° ë•Œë¬¸ì— `3.0.0>=` `<4.0.0`ì— í•´ë‹¹í•˜ëŠ” ë²„ì „ì¤‘ ìµœì‹ ë²„ì „ì¸ `bar@3.1.2`ê°€ ì„¤ì¹˜ë˜ì—ˆë‹¤. [caret ranges](https://docs.npmjs.com/cli/v6/using-npm/semver#caret-ranges-123-025-004)ì°¸ê³ 

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-12-19 á„‹á…©á„’á…® 7 57 24](https://user-images.githubusercontent.com/34048253/102687733-6aa71700-4234-11eb-947b-6454ee256e02.png)
<img src="https://user-images.githubusercontent.com/34048253/102688760-17d15d80-423c-11eb-9b0d-99d5ce93daa9.png" width="400" />

- `node_modules` í•˜ìœ„ì— `foo`í´ë”ê°€ ìƒê¸°ê³ , ì˜ì¡´ì„±ì„ ê°€ì§€ëŠ” íŒ¨í‚¤ì§€ë“¤ì€ `node_modules`/`.pnpm` í´ë”ì•ˆì— ê°ê°ì˜ ë²„ì „ì´ í¬í•¨ëœ ì´ë¦„ í´ë”ê°€ ìƒì„±ë˜ì—ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-12-19 á„‹á…©á„’á…® 8 47 42](https://user-images.githubusercontent.com/34048253/102688652-71855800-423b-11eb-947e-16fcc1a4b6c6.png)

- `.pnpm`/`bar@3.1.2`/`node_modules`/`base64-js` í´ë”ì™€ ê°™ì€ ë‚´ìš©ì´ `.pnpm`/`base64-js@1.5.1`ì— ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í–ˆëŠ”ë°, `ì‹¬ë³¼ë¦­ ë§í¬`ì¸ ê²ƒì„ í™•ì¸í•˜ì˜€ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2020-12-19 á„‹á…©á„’á…® 9 17 07](https://user-images.githubusercontent.com/34048253/102689198-8e238f00-423f-11eb-825e-0a3d1be005d0.png)

- ì‚¬ì‹¤ `node_modules` í•˜ìœ„ì— ìˆëŠ” í´ë”ë“¤ë„ `.pnpm`ì—ì„œ ê°€ì ¸ì˜¨ ê²ƒë“¤ì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
(ì„¤ì¹˜ë˜ëŠ” ëª¨ë“  ë²„ì „ë“¤ì€ .pnpmì— ê´€ë¦¬ë˜ê³ , ì½”ë“œì—ì„œ ì‚¬ìš©í•  ê²ƒë“¤ë§Œ node_modulesì— ì‹¬ë³¼ë¦­ ë§í¬ í˜•íƒœë¡œ ìƒì„±ë˜ëŠ” ê²ƒì´ë‹¤)


#### 2. bar@6.1.3 ì„¤ì¹˜
- `node_modules`/`bar` í´ë”ê°€ ìƒì„±ë˜ì—ˆê³ , `node_modules`/`.pnpm` í´ë”ì— ìƒˆë¡œ ì„¤ì¹˜ëœ `bar@6.1.3`ì˜ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ê°€ ì¶”ê°€ë˜ì—ˆë‹¤.<br>
(ì´ë¯¸ ì„¤ì¹˜ëœ ë²„ì „ì´ ìˆë‹¤ë©´, ìƒˆë¡œ ì„¤ì¹˜ë˜ì§€ ì•Šì„ ê²ƒìœ¼ë¡œ ì¶”ì¸¡ëœë‹¤.)

#### 3. bar@6.1.3 ì‚­ì œ
- `node_modules`/`bar` í´ë”ê°€ ì‚­ì œë˜ê³ , `node_modules`/`.pnpm` í´ë”ì— ì„¤ì¹˜ë˜ì—ˆë˜ `bar@6.1.3`ì˜ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ê°€ ì‚¬ë¼ì§€ë©°, `.pnpm`ì—ëŠ” 1ë²ˆ ê³¼ì •ì—ì„œ ì„¤ì¹˜ë˜ì—ˆë˜ í´ë”ë§Œ ë‚¨ì•„ìˆê²Œ ë˜ì—ˆë‹¤.

#### 4. foo@39ì˜ ì˜ì¡´ì„±ìœ¼ë¡œ ì„¤ì¹˜ëœ bar@3.1.2 ìˆ˜ë™ìœ¼ë¡œ ì„¤ì¹˜
- `bar@3.1.2`ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì¹˜í•´ë³¸ ê²°ê³¼, `.pnpm`ì— ì¡´ì¬í•˜ë˜ `bar@3.1.2`ì˜ ì‹¬ë³¼ë¦­ ë§í¬ê°€ `node_modules`/`bar`ë¡œ ìƒì„±ë˜ì—ˆë‹¤.

# ì¶”ê°€ìë£Œ (yarn 2)

<img src="https://user-images.githubusercontent.com/34048253/102710108-63930e00-42f3-11eb-8d20-cd806029f87c.png" width=600 />

ë¸”ë¡œê·¸ ë‚´ìš©ì„ ê³µìœ í•˜ë˜ ë„ì¤‘ yarn 2ì˜ ì •ë³´ë¥¼ ì•Œê²Œ ë˜ì—ˆë‹¤.

yarn 2ëŠ” í•œ í´ë”ì— íŒ¨í‚¤ì§€ë¥¼ ëª°ì•„ë„£ì„ ë¿ë§Œ ì•„ë‹ˆë¼ `.yarn/cache` í´ë”ì— zipíŒŒì¼ í˜•íƒœë¡œ ê´€ë¦¬í•˜ê³  `.pnp.js` íŒŒì¼ì— í•´ë‹¹ íŒ¨í‚¤ì§€(ë˜ëŠ” ì˜ì¡´ì„± íŒ¨í‚¤ì§€)ì˜ `ì´ë¦„`, `ë²„ì „`, `ê²½ë¡œ` ë“±ì˜ ì •ë³´ë¥¼ ì €ì¥í•˜ì—¬ node_modulesì—ì„œ ë°œìƒí•˜ë˜ ë¬¸ì œ ë¿ë§Œ ì•„ë‹ˆë¼, ê° íŒ¨í‚¤ì§€ë³„ í´ë” ì¡°ì°¨ ìƒì„±í•˜ì§€ ì•Šì•„ì„œ pnpmë³´ë‹¤ ë” ì¢‹ì•„ë³´ì¸ë‹¤.

![yarn2](https://user-images.githubusercontent.com/34048253/102711977-0605be00-4301-11eb-8f6d-954da11ba180.gif)

`import error (TS2307)` ì˜ í•´ê²°ë°©ë²•ì€ ì˜ ëª¨ë¥´ê² ë‹¤

```javascript
// .pnp.js íŒŒì¼ì˜ ì¼ë¶€
function $$SETUP_STATE(hydrateRuntimeState, basePath) {
  return hydrateRuntimeState({
    "packageRegistryData": [
      ["google-auth-library", [
        ["npm:6.1.3", {
          "packageLocation": "./.yarn/cache/google-auth-library-npm-6.1.3-ecb4934df9-ddf0289860.zip/node_modules/google-auth-library/",
          "packageDependencies": [
            ["google-auth-library", "npm:6.1.3"],
            ...
            ["lru-cache", "npm:6.0.0"]
          ],
          "linkType": "HARD",
        }]
      ]],
      ["googleapis", [ 
        ["npm:66.0.0", {
          "packageLocation": "./.yarn/cache/googleapis-npm-66.0.0-5fed4fcc24-b3d80d94e5.zip/node_modules/googleapis/",
          "packageDependencies": [
            ["googleapis", "npm:66.0.0"],
            ["google-auth-library", "npm:6.1.3"],
            ["googleapis-common", "npm:4.4.3"]
          ],
          "linkType": "HARD",
        }]
      ]]
    ]
  }, {basePath: basePath || __dirname});
}
```

# ê²°ë¡ 

dependencyë¥¼ í•œê³³ì—ì„œ ê´€ë¦¬í•˜ë©´ì„œ ë™ì¼ ë²„ì „ì˜ ì¤‘ë³µìƒì„±ì´ë‚˜ ê°™ì€ ì´ë¦„ ë‹¤ë¥¸ë²„ì „ì˜ dependency ìƒì„±ì‹œ íŒ¨í‚¤ì§€ê°€ ì‚­ì œë˜ì—ˆë‹¤ê°€ ë‹¤ë¥¸ ìœ„ì¹˜ì— ìƒˆë¡œ ìƒì„±ë˜ëŠ” ë“±ì˜ ë¶ˆí•„ìš”í•œ I/O ê³¼ì •ì„ ì—†ì• ëŠ” ê²ƒìœ¼ë¡œ pnpmì˜ ì¥ì ì„ í™•ì‹¤íˆ ì•Œê²Œ ë˜ì—ˆë‹¤.

ì´ë¡œì¨ reason-seoul ë ˆí¬ì—ì„œ ì„¤ëª…í•œ íƒ„ì†Œ ì ˆê° ë° SSDì˜ ìˆ˜ëª…ì„ ìœ„í•´ì„œ pnpmì„ ì‚¬ìš©í•œë‹¤ëŠ” ì´ìœ ë„ ì¶©ë¶„íˆ ë‚©ë“ì´ ë˜ì—ˆë‹¤.

í•˜ì§€ë§Œ pnpm ì‚¬ìš©ì‹œ dependencyê°€ ì„¤ì¹˜ë˜ì–´ìˆëŠ” node_modulesì— ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•œ ì ì´ ìˆëŠ”ë°, ì• ì´ˆì— npm, yarnì‚¬ìš©ì‹œ ê·¸ëŸ¬í•œ ë””ë ‰í† ë¦¬ ì ‘ê·¼ì´ ì œëŒ€ë¡œëœ ë°©ë²•ì¸ì§€ ì˜ì‹¬ë˜ëŠ” ìƒí™©ì´ì—ˆê¸° ë•Œë¬¸ì—,

**pnpmì˜ ì‚¬ìš©ì„ ì ê·¹ ê¶Œì¥í•˜ê³ ì‹¶ë‹¤.**

**yarn2ë„ ì‚¬ìš©í•´ë³´ì!**

# ì°¸ê³ ìë£Œ

- [pnpm, í”Œë«í•˜ì§€ ì•Šì€ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €](https://imch.dev/posts/pnpm-a-manager-what-is-not-flat)
- [NPM vs PNPM vs Yarn](https://rushjs.io/pages/maintainer/package_managers/)
- [reason-seoul](https://github.com/reason-seoul/reason-todomvc)
- [Yarn 2 ë°œí‘œ](https://seungho.dev/yarn-2-announced/)
